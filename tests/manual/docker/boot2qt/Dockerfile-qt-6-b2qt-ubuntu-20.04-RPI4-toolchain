
FROM ubuntu:20.04

RUN apt-get update && \
    apt-get upgrade -y && \
    DEBIAN_FRONTEND="noninteractive" apt-get install -y --no-install-recommends \
        curl \
        file \
        xz-utils \
        locales \
        git-core \
        vim \
        python3 \
        less


RUN locale-gen en_US.UTF-8
ENV LC_ALL en_US.UTF-8

# The path to the toolchain, generated by Dockerfile-qt-6-b2qt-ubuntu-20.04-RPI4-build
# Specify yours with "--build-arg toolchain_source=/path/to/toolchain.sh"
ARG toolchain_source=./deploy/sdk/b2qt-aarch64-meta-toolchain-b2qt-embedded-qt6-sdk-raspberrypi4.sh

COPY $toolchain_source toolchain.sh

# Install the toolchain
RUN chmod +x toolchain.sh && \
    ./toolchain.sh -d /opt/toolchain -y && \
    rm toolchain.sh

# Create an entrypoint script that sets up the toolchain
RUN echo "#!/bin/sh" > /entrypoint.sh && \
    echo ". /opt/toolchain/environment-setup-*" >> /entrypoint.sh && \
    echo "exec \"\$@\"" >> /entrypoint.sh && \
    chmod +x /entrypoint.sh

ENTRYPOINT ["/entrypoint.sh"]
CMD ["/bin/bash"]
